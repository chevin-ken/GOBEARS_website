<!DOCTYPE html>
<html lang="en">
  <head>
    <title>GOBEARS EE106A Final Project</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:100,200,300,400,700,800" rel="stylesheet">

    <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
    <link rel="stylesheet" href="css/animate.css">
    
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/ionicons.min.css">

    <link rel="stylesheet" href="css/bootstrap-datepicker.css">
    <link rel="stylesheet" href="css/jquery.timepicker.css">

    
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/icomoon.css">
    <link rel="stylesheet" href="css/style.css">
    <script
      src="https://code.jquery.com/jquery-3.3.1.js"
      integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
      crossorigin="anonymous">
    </script>
    <script> 
      $(function(){
        $("#navbar").load("navbar.html"); 
        $("#footer").load("footer.html"); 
      });
    </script> 
  </head>
  <body>
    
    <div id="navbar"></div>
    <!-- END nav -->
    
    <section class="home-slider ftco-degree-bg">
      <div class="slider-item">
        <div class="overlay"></div>
        <div class="container">
          <div class="row slider-text align-items-center justify-content-center">
            <div class="col-md-12 ftco-animate text-center">
              <h1 class="mb-4">Cs 194 Final Project:
                <strong class="typewrite" data-period="2000" data-type='[ "Augmented Reality", "Image Quilting", "Light Field Camera"]'>
                  <span class="wrap"></span>
                </strong>
              </h1>
              <p>Kevin Chen, Praveen Batra</p>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- END slider -->

    <section class="ftco-section" id="part1">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Introduction </h2>
            <p>Describe the end goal of your project.</p>
            <p>Why is this an interesting project? What interesting problems do you need to solve to make your
              solution work?</p>
            <p>In what real-world robotics applications could the work from your project be useful?</p>
          </div>
        </div>
    </section>

    <section class="ftco-section" id="part2">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Design</h2>
            <p>What design criteria must your project meet? What is the desired functionality?</p>
            <p>Describe the design you chose</p>
            <p>What design choices did you make when you formulated your design? What trade-offs did you
              have to make?</p>
            <p>How do these design choices impact how well the project meets design criteria that would be
              encountered in a real engineering application, such as robustness, durability, and efficiency?</p>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section" id="part3">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Implementation</h2>
          </div>
          <br>
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h5>Hardware</h5>
          </div>
          <div class="col-md-12 text-left heading-section ftco-animate">
            <p>The hardware setup for GOBEARS was fairly straightforward. We used Baxter as the robot, Baxter right hand for the camera, and Baxter left arm with the gripper attachment for movement. Here is what our workplace setup looks like.</p>
          </div>
        </div>
        <!-- Workspace setup diagram  -->
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/quilting/quilt_cut/template.png" class="img-part2-texture">
              </div>
              <p>Workspace</p>
            </div>
          </div>
        </div>
        <br>
        <!-- Talk about trowel modification, and other substituted parts (like plant, water, dirt substitutions) -->
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h5>Parts</h5>
          </div>
          <div class="col-md-12 text-left heading-section ftco-animate">
            <p>Our solution consisted of several items that are used in each gardening action. Each one of these items has an AR tag attached to it in order for Baxter to be able to detect the relative position of these objects using AR tracking. </p>
            <p>In the first action, digging, we needed a trowel and a dirt bin to dig out of. 
              For the trowel, we built a gripper add-on using cardboard that would help Baxter be able to grip the trowel firmly, and prevent tilting of the trowel along its major axis. 
              The attachment consists of two large carboard square pieces with two smaller cardboard pieces that are attached perpendicular to the square pieces. The attachment is then fortified with tape. 
              These smaller square pieces serve to resist torque from gravity while the trowel is being held by Baxter. For the dirt bin, we used a plastic box that was filled with dried beans. We chose to use
              dried beans instead of actual dirt simply for lab cleanliness reasons, as it is easier to pick up beans from the ground compared to dirt. This was definitely a good choice, as we had to pick up
              beans from the ground multiple times in the lab while fine-tuning our digging motion. </p>
           </div>
        </div>
        <!-- Trowel diagram with modified gripper -->
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/quilting/quilt_cut/template.png" class="img-part2-texture">
              </div>
              <p>Trowel with modified gripper</p>
            </div>
          </div>
        </div>
        <br>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/quilting/quilt_cut/template.png" class="img-part2-texture">
              </div>
              <p>Dirt Bin</p>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-left heading-section ftco-animate">
            <p>In the next action, planting, we used a green squishy toy to emulate a plant. We chose this object because it was relatively easy to grip, and because it was green. </p>
           </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/quilting/quilt_cut/template.png" class="img-part2-texture">
              </div>
              <p>Plant</p>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-left heading-section ftco-animate">
            <p>In the last action, watering, we used a plastic water bottle to emulate a watering can. We used a plastic water bottle because it can also be gripped by Baxter, and it is light enough when it is about a third of the way full for Baxter to tilt it downwards when watering the plant. 
              We also did not want to pour actual water in a lab due to lab safety reasons, so we kept the water bottle closed throughout.
            </p>
           </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/quilting/quilt_cut/template.png" class="img-part2-texture">
              </div>
              <p>Watering Can</p>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h5> Software </h5>
          </div>
          <div class="col-md-12 text-left heading-section ftco-animate">
            <p> The software we used for the project is built using ROS and python. 
              The overall structure involves running many lower level nodes that perform basic functionality such as vision and control, and then writing
              our own logic wrapper over these nodes to actually perform our gardening actions.
            </p> 
            <p> For lower level nodes, we used some files from Baxter packages. These include baxter_grippers.launch from baxter_move_it_config to handle gripper control,
              joint_trajectory_action_server.py from baxter_interface to handle actuation, and camera_control.py from baxter_tools to enable the right hand camera.
              We also used the ar-track_alvar.launch launchfile from the ar_track_alvar package in order to enable AR tag tracking. We modified the launch file 
              slightly such that it subscribes to the right hand camera topics for image and camera intrinsics information, and also publishes the poses of the AR tags
              with respect to the base frame by subscribing to a tf static transform publisher.
            </p>
            <p> For our higher level wrapper code, we also subdivided that into several levels of modularity. We first copied over the motion planner that we used in 
              lab 7 to handle our inverse kinematics path planning, as well as plan execution. Then, we defined a Baxter class that directly interfaces with the 
              path planner. Baxter includes a move to pose method that takes in a pose and runs the path planner to plan and execute a trajectory to this pose. 
              Baxter also handles gripper control, which includes commands such as open, close, and calibrate gripper. Baxter provides vision functions as well, including 
              scan and get AR tag pose. Baxter has a node that subscribes /ar_pose_marker, which is the topic that ar_track_alvar publishes AR tag pose information to.
              During scan, Baxter will retrieve all AR tag information necessary in order to complete its current task and store the poses. Then, when the poses are needed,
              Baxter provides the get AR tag pose function which returns the pose of the requested AR tag.
            </p>
            <p> Our highest level of abstraction is the GOBEARS class, which interfaces with the Baxter class in order to perform the gardening actions of 
              digging, planting, and watering. We defined relative poses to each AR tag that Baxter needs to reach in order to accomplish each step. GOBEARS will 
              execute trajectories by retrieving AR tag poses from Baxter, transform the relative poses from the AR tag frames to the base frame using homogenous transforms,
              and then plan and execute trajectories to these poses by using Baxter's move to pose method. It will also call Baxter's close and open gripper methods whenever necessary, and will call Baxter's scan method between each task in order to get the AR tag poses needed for each task.
              In order to calculate the 4x4 homogenous transform matrices, we create a 
              geometry_msgs.Transform object using the orientation and position of the AR pose, call scipy's from_quat method to turn the orientation quaternion into a 3x3 rotation matrix, and then
              compose the 4x4 matrix using the 3x3 rotation matrix and the translation vector.
              
            </p>
           </div>
        </div>
        <!-- Code structure diagram -->
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <img src="images/code_diagram.png" width=500px height=auto>
              </div>
              <p>Code structure diagram</p>
            </div>
          </div>
        </div>
        <br>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h5> Runtime Steps </h5>
          </div>
          <div class="col-md-12 text-left heading-section ftco-animate"></div>
            <h6> Step 1: Setup </h6>
            <p> Run the low level nodes, which are the joint_trajectory_action_server, camera_control for the right hand camera, baxter_grippers launchfile, and the ar_track_alvar launchfile. 
              Run RVIZ to visualize the AR tags and planned trajectory animations.</p> 
            <h6> Step 2: Baxter Initialize </h6> 
            <p> Initializing Baxter involves several steps. First, it will initialize a path planner object for its left arm. It will also create a box obstacle for the table with the planner to ensure that
              the trajectories computed by the path planner will not cause collisions with the table. Then, it will initialize a subscriber that subscribes to 
              the /ar_pose_marker topic in order to receive AR pose information. It will wait for the callback to finish updating its stored list of AR tag positions, and then will complete initialization by calibrating the left gripper.
            </p>
            <h6> Step 3: Dig</h6> 
            <p> First, we will make sure to place the trowel and the dirt bin in locations on the table that can be reached within Baxter's workspace. We will move Baxter left arm to a predefined reset pose. We run scan again to confirm that we have the positions of the trowel and 
              dirt bin. Then, we move to a hover pose above the trowel, and then move to a pickup pose where the gripper is in position to pick up the trowel. Note that all predefined poses that we mention are poses relative to the AR tag 
              that we retreived using tf echo. In order to actually move Baxter's left arms to the desired positions relative to the AR tag, we need to compute a homogenous transform
              to transform the relative poses from the AR tag frame to the base frame. Also, the purpose of the hover poses is to ensure that we don't knock over the objects we are trying to pick up when 
              moving to the next pickup pose. We close the gripper and then move to a hover position above the dirt bin such that Baxter
              is now holding the trowel right over the dirt bin, angled downwards. We can then lower the trowel such that it is digging into the beans. We then execute a shoveling motion by performing a trajectory where we increase the pitch 
              of the gripper to tilt it, and then move the shovel forward in the bin such that it pushes the beans out from the center, effectively creating a hole. We enforce orientation constraints throughout this 
              motion so that the trowel continues to be angled in a way that it can displace the beans. Last, we move the trowel back to its original starting position, and release the gripper.
            </p>
            <h6> Step 4: Plant </h6>
            <p> We clear the trowel from the workspace and put the plant on the table. We will start by moving to the same reset pose from the previous step and run scan to confirm that we have the positions of the plant and the dirt bin. Then, we
              move to a hover pose about the plant, and move downwards into a pickup pose where we close the gripper and pick up the plant. Next, we move to a hover pose above the dirt bin and then move
              straight down so that the plant is above the hole we created in the previous step. We then release the gripper so the plant is placed in the hole and move back upwards to the hover pose above the 
              dirt bin. Throughout these motions, we maintain an orientation where the gripper is pointed straight down.
            </p>
            <h7> Step 5: Water </h7>
            <p> We clear the plant from the workspace and put the water bottle on the table. Once again, we move to the reset position and run scan to confirm that we have the positions of the water bottle and the dirt bin. 
              Then, we move to a water pickup hover pose, which is actually different from the hover poses in the previous steps. Whereas before the hover poses were above the object, in the case of the water bottle, we want to
              pick up the water bottle from the side, so we need to move to a pose where the gripper is perpendicular to the major axis of the water bottle. Then, we can move the gripper forward to the water pickup pose and close the gripper to grip the 
              water bottle. Then, we move the water bottle to a hover pose above the dirt bin. Here, we enforce orientation constraints to prevent the water bottle from tilting over,
              as in a real life gardening situation, we don't want our watering can to spill out its water before reaching its desired pose. Then, we move to our next watering pose, 
              in which Baxter will tilt the water bottle forward to simulate watering the plant. Finally, we will move back to the water pickup hover pose, followed by the water pickup pose and then open the gripper to return
              the water bottle to its original position.
            </p>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section" id="part4">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Results</h2>
            <p>How well did your project work? What tasks did it perform</p>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <p>Dig Video</p>
          </div>
        </div>
        <div class="row justify-content-center">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <video src="images/ar/rubiks2.mp4" autoplay loop muted playsinline width="300px" height="auto">
                </video>  
              </div>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <p>Plant Video</p>
          </div>
        </div>
        <div class="row justify-content-center">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <video src="images/ar/rubiks2.mp4" autoplay loop muted playsinline width="300px" height="auto">
                </video>  
              </div>
            </div>
          </div>
        </div>
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <p>Water Video</p>
          </div>
        </div>
        <div class="row justify-content-center">
          <div class="col-md-12 d-flex align-self-stretch ftco-animate justify-content-center">
            <div class="media block-10 d-block text-center">
              <div class="member-card d-flex justify-content-center">
                <video src="images/ar/rubiks2.mp4" autoplay loop muted playsinline width="300px" height="auto">
                </video>  
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section" id="part5">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Conclusion</h2>
            <p>Discuss your results. How well did your finished solution meet your design criteria?</p>
            <p>Did you encounter any particular difficulties?</p>
            <p>Does your solution have any flaws or hacks? What improvements would you make if you had additional time?</p>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section" id="part6">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Team</h2>
          </div>
        </div>
      </div>
    </section>

    <section class="ftco-section" id="part6">
      <div class="container">
        <div class="row justify-content-center mb-4 pb-4">
          <div class="col-md-12 text-center heading-section ftco-animate">
            <h2>Additional Materials</h2>
            <p>Github: https://github.com/chevin-ken/GOBEARS</p>
            <p>Launch files: see ar_track_alvar.launch in the ar_track_alvar module on Github. </p>
          </div>
        </div>
      </div>
    </section>

    <div id="footer"></div>
  
  <!-- loader -->
  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px"><circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee"/><circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00"/></svg></div>


  <script src="js/jquery.min.js"></script>
  <script src="js/jquery-migrate-3.0.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/bootstrap-datepicker.js"></script>
  <script src="js/jquery.timepicker.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
  <script src="js/google-map.js"></script>
  <script src="js/main.js"></script>
    
  </body>
</html>